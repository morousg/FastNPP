option(BUILD_DOCUMENTATION "Use Doxygen to create the HTML based API documentation" OFF)

if(${BUILD_DOCUMENTATION})
    find_package(Doxygen REQUIRED dot)
    set(DOXYGEN_PROJECT_NAME ${CMAKE_PROJECT_NAME})    
    set(DOXYGEN_FILE_PATTERNS  *.markdown *.md)
    set(DOXYGEN_MARKDOWN_SUPPORT YES)
    set(DOXYGEN_USE_MDFILE_AS_MAINPAGE  ${CMAKE_SOURCE_DIR}/README.md)
    set(DOXYGEN_GENERATE_LATEX NO)
    set(DOXYGEN_ALLOW_UNICODE_NAMES YES)
    set(DOXYGEN_DOT_IMAGE_FORMAT svg)
    set(DOXYGEN_INTERACTIVE_SVG YES)
    set(DOXYGEN_WARN_IF_UNDOCUMENTED NO)
    set(DOXYGEN_OPTIMIZE_OUTPUT_FOR_C YES)
    set(DOXYGEN_FILE_PATTERNS "*.cuh;*.h")
    set(DOXYGEN_EXTENSION_MAPPING "cuh=c++;")
    set(DOXYGEN_EXTRACT_ALL YES)
    set(DOXYGEN_EXCLUDE_PATTERNS "*/tests/* */benchmarks/*")
           
    if(MSVC)
        set(DOXYGEN_CPP_CLI_SUPPORT YES)
    endif()
    set(DOXYGEN_GENERATE_TREEVIEW YES)
    set(DOXYGEN_CALLER_GRAPH YES)
    set(DOXYGEN_CALL_GRAPH YES)

    set(DOXYGEN_HTML_OUTPUT ${CMAKE_BINARY_DIR}/docs)
    doxygen_add_docs(GEN_DOCS ${CMAKE_SOURCE_DIR} COMMENT "Generate html pages")
    set_property(TARGET GEN_DOCS PROPERTY FOLDER "CMake")
endif()
